{"version":3,"sources":["webpack:///./src/views/FbLogin.vue","webpack:///./src/methods/fb.js","webpack:///./src/views/FbLogin.vue?6cab"],"names":["_createElementVNode","_createElementBlock","_hoisted_1","_createVNode","_component_fb58login_button","scope","onlogin","_toDisplayString","$setup","initFacebook","store","useStore","window","fbAsyncInit","console","log","FB","init","appId","process","cookie","xfbml","version","commit","AppEvents","logPageView","d","s","id","js","fjs","getElementsByTagName","getElementById","createElement","src","parentNode","insertBefore","document","name","setup","router","useRouter","computed","state","status","ref","checkLoginState","value","getLoginStatus","response","statusChangeCallback","authResponse","getProfile","getFBData","userID","picture","data","url","isLogin","Promise","resolve","reject","api","fbUserName","replace","googleUserName","push","onMounted","__exports__","render"],"mappings":"yIAEIA,eAAkB,SAAf,eAAW,G,wFADhBC,eASM,YARJC,EACAC,eAIkBC,EAAA,CAHhBC,MAAM,mCACNC,QAAQ,oBAGVN,eAAmB,SAAAO,eAAbC,UAAM,K,kFCNHC,EAAe,WAC1B,IAAMC,EAAQC,iBAEdC,OAAOC,YAAc,WACnBC,QAAQC,IAAI,eAEZC,GAAGC,KAAK,CACNC,MAAOC,mBACPC,QAAQ,EACRC,OAAO,EACPC,QAAS,UAEXZ,EAAMa,OAAO,QAASP,IACtBA,GAAGQ,UAAUC,iBAIjB,SAAWC,EAAGC,EAAGC,GAEf,IAAIC,EADJf,QAAQC,IAAI,kBAEZ,IAAIe,EAAMJ,EAAEK,qBAAqBJ,GAAG,GAChCD,EAAEM,eAAeJ,KAGrBC,EAAKH,EAAEO,cAAcN,GACrBE,EAAGD,GAAKA,EACRC,EAAGK,IAAM,4CACTJ,EAAIK,WAAWC,aAAaP,EAAIC,KAVlC,CAWGO,SAAU,SAAU,kB,gBDbR,GACbC,KAAM,UACNC,MAFa,WAGXzB,QAAQC,IAAI,aACZ,IAAMyB,EAASC,iBACT/B,EAAQC,iBACRK,EAAK0B,gBAAS,kBAAMhC,EAAMiC,MAAM3B,MAChC4B,EAASC,eAAI,IAEbC,EAAkB,WACtB9B,EAAG+B,MAAMC,gBAAe,SAAUC,GAChCC,EAAqBD,OAInBC,EAAuB,SAACD,GAC5BnC,QAAQC,IAAIkC,GACZ,IAAQE,EAAyBF,EAAzBE,aAAcP,EAAWK,EAAXL,OACP,cAAXA,EAEFQ,EAAW,CAAED,iBAGbP,EAAOG,MAAQ,kCAIbK,EAAS,uDAAI,oHAASD,EAAT,EAASA,aAAT,SACME,EAAU,OADhB,uBACTf,EADS,EACTA,KACRD,SAASjB,OAAT,qBAAgCkB,GAFf,SAISe,EAAU,8BAAD,cACDF,QADC,IACDA,OADC,EACDA,EAAcG,OADb,gCAJlB,gBAITC,EAJS,EAITA,QAGRlB,SAASjB,OAAT,2BAA+BmC,QAA/B,IAA+BA,GAA/B,UAA+BA,EAASC,YAAxC,aAA+B,EAAeC,KAE9CC,IATiB,4CAAJ,sDAYTL,EAAY,SAACI,GACjB,OAAO,IAAIE,SAAQ,SAACC,EAASC,GAC3B7C,EAAG+B,MAAMe,IAAIL,GAAK,SAAUR,GAC1BnC,QAAQC,IAAI,YAAakC,GACzBW,EAAQX,UAKRS,EAAU,WACd,IAAMK,EAAa1B,SAASjB,OAAO4C,QAAQ,mDAAoD,MACzFC,EAAiB5B,SAASjB,OAAO4C,QAAQ,uDAAwD,MAClGC,EAEMF,GACTvB,EAAO0B,KAAK,KAFZ1B,EAAO0B,KAAK,iBAYhB,OANAC,gBAAU,WACR1D,IACAG,OAAOkC,gBAAkBA,EACzBY,OAGK,CAAEZ,kBAAiBI,uBAAsBE,aAAYR,SAAQc,a,qBE5ExE,MAAMU,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD","file":"js/chunk-2d208c0a.62a8baeb.js","sourcesContent":["<template>\r\n  <div>\r\n    <p>請登入Facebook</p>\r\n    <fb:login-button\r\n      scope=\"public_profile,email,user_photos\"\r\n      onlogin=\"checkLoginState\"\r\n    >\r\n    </fb:login-button>\r\n    <p>{{ status }}</p>\r\n\r\n  </div>\r\n</template>\r\n<script>\r\nimport { initFacebook } from '@/methods/fb'\r\nimport { onMounted, ref, computed } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { useRouter } from 'vue-router'\r\nexport default {\r\n  name: 'fbLogin',\r\n  setup () {\r\n    console.log('FBcreated')\r\n    const router = useRouter()\r\n    const store = useStore()\r\n    const FB = computed(() => store.state.FB)\r\n    const status = ref('')\r\n\r\n    const checkLoginState = () => {\r\n      FB.value.getLoginStatus(function (response) {\r\n        statusChangeCallback(response)\r\n      })\r\n    }\r\n\r\n    const statusChangeCallback = (response) => {\r\n      console.log(response)\r\n      const { authResponse, status } = response\r\n      if (status === 'connected') {\r\n        // Logged into your app and Facebook.\r\n        getProfile({ authResponse })\r\n      } else {\r\n        // The person is logged into Facebook, but not your app.\r\n        status.value = 'Please log ' + 'into this app again'\r\n      }\r\n    }\r\n\r\n    const getProfile = async ({ authResponse }) => {\r\n      const { name } = await getFBData('/me')\r\n      document.cookie = `fbUserName=${name}`\r\n\r\n      const { picture } = await getFBData(\r\n          `https://graph.facebook.com/${authResponse?.userID}?fields=picture&type=square`\r\n      )\r\n      document.cookie = `fbUserImg=${picture?.data?.url}`\r\n\r\n      isLogin()\r\n    }\r\n\r\n    const getFBData = (url) => {\r\n      return new Promise((resolve, reject) => {\r\n        FB.value.api(url, function (response) {\r\n          console.log('response ', response)\r\n          resolve(response)\r\n        })\r\n      })\r\n    }\r\n\r\n    const isLogin = () => {\r\n      const fbUserName = document.cookie.replace(/(?:(?:^|.*;\\s*)fbUserName\\s*=\\s*([^;]*).*$)|^.*$/, '$1')\r\n      const googleUserName = document.cookie.replace(/(?:(?:^|.*;\\s*)googleUserName\\s*=\\s*([^;]*).*$)|^.*$/, '$1')\r\n      if (!googleUserName) {\r\n        router.push('/googleLogin')\r\n      } else if (fbUserName) {\r\n        router.push('/')\r\n      }\r\n    }\r\n\r\n    onMounted(() => {\r\n      initFacebook()\r\n      window.checkLoginState = checkLoginState\r\n      isLogin()\r\n    })\r\n\r\n    return { checkLoginState, statusChangeCallback, getProfile, status, isLogin }\r\n  }\r\n\r\n}\r\n</script>\r\n<style lang=\"\">\r\n\r\n</style>\r\n","import { useStore } from 'vuex'\r\n\r\nexport const initFacebook = () => {\r\n  const store = useStore()\r\n\r\n  window.fbAsyncInit = function () {\r\n    console.log('fbAsyncInit')\r\n    /* global FB */\r\n    FB.init({\r\n      appId: process.env.VUE_APP_FB_APP_ID,\r\n      cookie: true,\r\n      xfbml: true,\r\n      version: 'v14.0'\r\n    })\r\n    store.commit('setFB', FB)\r\n    FB.AppEvents.logPageView()\r\n  }\r\n}\r\n\r\n(function (d, s, id) {\r\n  console.log('facebook-jssdk')\r\n  var js\r\n  var fjs = d.getElementsByTagName(s)[0]\r\n  if (d.getElementById(id)) {\r\n    return\r\n  }\r\n  js = d.createElement(s)\r\n  js.id = id\r\n  js.src = 'https://connect.facebook.net/zh_TW/sdk.js'\r\n  fjs.parentNode.insertBefore(js, fjs)\r\n})(document, 'script', 'facebook-jssdk')\r\n","import { render } from \"./FbLogin.vue?vue&type=template&id=4775a0f0\"\nimport script from \"./FbLogin.vue?vue&type=script&lang=js\"\nexport * from \"./FbLogin.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\user\\\\OneDrive\\\\Desktop\\\\vue3-demo-myself\\\\oakmega\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}